version: 2

target_branches:
  - master

application:
  chart_path: '.helm/charts/avro-schema-registry'
  chart_vars_path: '.helm/releases/avro-schema-registry/dqa.yaml'
  image: 'quay.io/dollarshaveclub/avro-schema-registry'
  value_overrides:
#   - "dqaIngress.enabled=true" # uncomment to enable on DQAs

dependencies:
  direct:
    - name: avro-schema-registry-postgres
      chart_path: '.helm/charts/avro-schema-registry-postgres'
      chart_vars_path: '.helm/releases/avro-schema-registry-postgres/dqa.yaml'
    - name: avro-schema-registry-db-migration
      chart_path: '.helm/charts/avro-schema-registry-db-migration'
      chart_vars_path: '.helm/releases/avro-schema-registry-db-migration/dqa.yaml'
      requires:
        - avro-schema-registry-postgres
  environment:

notifications:
  github:
    commit_statuses:
      templates:
        success:
          description: "The Acyl environment {{ .EnvName }} was created successfully."
          target_url: "https://avro-schema-registry-{{ .EnvName }}.dqa.wtf"
  templates:
    success:
      title: "üèÅ Environment Ready"
      sections:
        - title: "{{ .EnvName }}"
          text: "{{ .Repo }}\nPR #{{ .PullRequest }}: {{ .SourceBranch }} ‚û°Ô∏è {{ .BaseBranch }}\nURL if enabled: https://avro-schema-registry-{{ .EnvName }}.dqa.wtf\nK8s Namespace: {{ .K8sNamespace }}"
          style: "good"
